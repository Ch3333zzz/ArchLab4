name: pause-test
config:
  pause_tick: 3
source:
  language: lisp
  code: |
    (print "A")
    (print "B")
    (print "C")
expect:
  out_stdout: A
  state: paused
  out_code: !!binary |
    FAAAAABGAAAAABQCAAAARgAAAAAUBAAAAEYAAAAAAQAAAAA=
  out_code_hex: |-
    0 - 1400000000 - LOAD_CONST 0
    5 - 4600000000 - PRINT
    10 - 1402000000 - LOAD_CONST 2
    15 - 4600000000 - PRINT
    20 - 1404000000 - LOAD_CONST 4
    25 - 4600000000 - PRINT
    30 - 0100000000 - HALT
  out_log: |
    DEBUG root:processor.py:357 No more scheduled input and mmio_in_buffer empty -> input closed (EOF)
    DEBUG root:processor.py:339 STATE: RUNNING    STEP: COMMAND_FETCH   TICK:    0 PC:  4096 ADDR:     0 MEM[ADDR]:          1 ACC:          0 C: 0 V: 0	INSTR: fetch
    DEBUG root:processor.py:339 STATE: RUNNING    STEP: OPERAND_FETCH   TICK:    0 PC:  4096 ADDR:     0 MEM[ADDR]:          1 ACC:          0 C: 0 V: 0	INSTR: LOAD_CONST 0
    DEBUG root:processor.py:396 Tick 0 PC 4096: LOAD_CONST 0 ACC=0
    DEBUG root:processor.py:339 STATE: RUNNING    STEP: EXECUTION       TICK:    0 PC:  4101 ADDR:     1 MEM[ADDR]:         65 ACC:          0 C: 0 V: 0	INSTR: LOAD_CONST 0
    DEBUG root:processor.py:339 STATE: RUNNING    STEP: COMMAND_FETCH   TICK:    1 PC:  4101 ADDR:     1 MEM[ADDR]:         65 ACC:          0 C: 0 V: 0	INSTR: fetch
    DEBUG root:processor.py:339 STATE: RUNNING    STEP: OPERAND_FETCH   TICK:    1 PC:  4101 ADDR:     1 MEM[ADDR]:         65 ACC:          0 C: 0 V: 0	INSTR: PRINT
    DEBUG root:processor.py:396 Tick 1 PC 4101: PRINT 0 ACC=0
    DEBUG root:processor.py:646 PRINT: Detected pstr at 0 len=1
    DEBUG root:processor.py:241 [MMIO OUT] wrote 65 -> char: A
    DEBUG root:processor.py:339 STATE: RUNNING    STEP: EXECUTION       TICK:    1 PC:  4106 ADDR:     2 MEM[ADDR]:          1 ACC:          0 C: 0 V: 0	INSTR: PRINT
    DEBUG root:processor.py:339 STATE: RUNNING    STEP: COMMAND_FETCH   TICK:    2 PC:  4106 ADDR:     2 MEM[ADDR]:          1 ACC:          0 C: 0 V: 0	INSTR: fetch
    DEBUG root:processor.py:339 STATE: RUNNING    STEP: OPERAND_FETCH   TICK:    2 PC:  4106 ADDR:     2 MEM[ADDR]:          1 ACC:          0 C: 0 V: 0	INSTR: LOAD_CONST 2
    DEBUG root:processor.py:396 Tick 2 PC 4106: LOAD_CONST 2 ACC=0
    DEBUG root:processor.py:339 STATE: RUNNING    STEP: EXECUTION       TICK:    2 PC:  4111 ADDR:     3 MEM[ADDR]:         66 ACC:          2 C: 0 V: 0	INSTR: LOAD_CONST 2
    DEBUG root:processor.py:339 STATE: PAUSED     STEP: PAUSE_CHECK     TICK:    3 PC:  4111 ADDR:     3 MEM[ADDR]:         66 ACC:          2 C: 0 V: 0	INSTR: pause
